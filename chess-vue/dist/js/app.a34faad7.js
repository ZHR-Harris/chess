(function(e){function t(t){for(var i,s,c=t[0],o=t[1],u=t[2],p=0,v=[];p<c.length;p++)s=c[p],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&v.push(a[s][0]),a[s]=0;for(i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i]);l&&l(t);while(v.length)v.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],i=!0,c=1;c<n.length;c++){var o=n[c];0!==a[o]&&(i=!1)}i&&(r.splice(t--,1),e=s(s.s=n[0]))}return e}var i={},a={app:0},r=[];function s(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=i,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(n,i,function(t){return e[t]}.bind(null,i));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/app/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],o=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var l=o;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var i=n("2b0e"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("h3",[e._v(e._s(e.boardStr)+" "),n("button",{on:{click:e.reset}},[e._v("重新开始")])]),n("div",{attrs:{id:"MaxBox"}},[e._l(4,(function(t){return n("div",{key:t-1,staticClass:"line"},e._l(e.rangeX,(function(i){return n("m-piece",e._b({key:i,attrs:{x:i,y:t-1},nativeOn:{click:function(n){return e.onPieceClick(i,t-1)}}},"m-piece",e.pieceArgs,!1))})),1)})),n("div",{staticClass:"line river1"},e._l(e.rangeX,(function(t){return n("m-piece",e._b({key:t,attrs:{x:t,y:4},nativeOn:{click:function(n){return e.onPieceClick(t,4)}}},"m-piece",e.pieceArgs,!1))})),1),e._m(0),n("div",{staticClass:"line river2"},e._l(e.rangeX,(function(t){return n("m-piece",e._b({key:t,attrs:{x:t,y:5},nativeOn:{click:function(n){return e.onPieceClick(t,5)}}},"m-piece",e.pieceArgs,!1))})),1),e._l(4,(function(t){return n("div",{key:t+5,staticClass:"line"},e._l(e.rangeX,(function(i){return n("m-piece",e._b({key:i,attrs:{x:i,y:t+5},nativeOn:{click:function(n){return e.onPieceClick(i,t+5)}}},"m-piece",e.pieceArgs,!1))})),1)}))],2),e.humanSideText?n("h4",{style:e.humanSideStyle},[e._v(" 人："+e._s(e.humanSideText)+" "),e.activePiece?n("span",[e._v("选中棋子："+e._s(e.activePiece))]):e._e(),e.processing?n("span",[e._v("（正在思考...）")]):e._e()]):e._e()])},r=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"boxCenter"},[n("div",{staticClass:"boxCenterLeft"},[e._v("河"),n("br"),n("br"),e._v("界")]),n("div",{staticClass:"boxCenterRight"},[e._v("河"),n("br"),n("br"),e._v("界")])])}],s=n("1da1"),c=n("b85c"),o=(n("99af"),n("2ca0"),n("96cf"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"lattice"},[n("div",{class:e.classes,style:e.style}),n("div",[e.isPoint([4,1],[5,2],[4,8],[5,9])?n("canvas",{staticClass:"myCanvas"}):e._e(),e.isPoint([1,2],[7,2],[2,3],[4,3],[6,3],[8,3],[2,6],[4,6],[6,6],[8,6],[1,7],[7,7])?n("div",{staticClass:"chessItme chessItme1"}):e._e()]),n("div",[e.isPoint([4,1],[3,2],[4,8],[3,9])?n("canvas",{staticClass:"myCanvas2"}):e._e(),e.isPoint([1,2],[7,2],[2,3],[4,3],[6,3],[0,3],[2,6],[4,6],[6,6],[0,6],[1,7],[7,7])?n("div",{staticClass:"chessItme chessItme2"}):e._e()]),n("div",[e.isPoint([5,0],[4,1],[5,7],[4,8])?n("canvas",{staticClass:"myCanvas2"}):e._e(),e.isPoint([1,2],[7,2],[2,3],[4,3],[6,3],[8,3],[2,6],[4,6],[6,6],[8,6],[1,7],[7,7])?n("div",{staticClass:"chessItme chessItme3"}):e._e()]),n("div",[e.isPoint([3,0],[4,1],[3,7],[4,8])?n("canvas",{staticClass:"myCanvas"}):e._e(),e.isPoint([1,2],[7,2],[2,3],[4,3],[6,3],[0,3],[2,6],[4,6],[6,6],[0,6],[1,7],[7,7])?n("div",{staticClass:"chessItme chessItme4"}):e._e()])])}),u=[],l=(n("a15b"),{K:"/app/pieces/3.png",A:"/app/pieces/6.png",B:"/app/pieces/7.png",N:"/app/pieces/4.png",R:"/app/pieces/2.png",C:"/app/pieces/5.png",P:"/app/pieces/1.png",k:"/app/pieces/3-3.png",a:"/app/pieces/6-6.png",b:"/app/pieces/7-7.png",n:"/app/pieces/4-4.png",r:"/app/pieces/2-2.png",c:"/app/pieces/5-5.png",p:"/app/pieces/1-1.png"}),p={data:function(){return{}},props:["board","x","y","active","targets","lastMoveCoords"],computed:{piece:function(){var e=this.board[this.y];if(e){var t=e[this.x];if(t)return t}return null},classes:function(){var e=["chess"];return this.isActive&&e.push("chess-active"),e},style:function(){var e={},t=[];this.isTarget&&t.push('url("/app/pieces/circle.png")');var n,i=Object(c["a"])(this.lastMoveCoords);try{for(i.s();!(n=i.n()).done;){var a=n.value;a[0]===this.x&&a[1]===this.y&&t.push('url("/app/pieces/move_indicator.svg")')}}catch(r){i.e(r)}finally{i.f()}return this.piece&&t.push('url("'.concat(l[this.piece],'")')),t.length>0&&(e.backgroundImage=t.join(",")),e},isActive:function(){return this.active&&this.active[0]==this.x&&this.active[1]==this.y},isTarget:function(){var e,t=Object(c["a"])(this.targets);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(n[0]==this.x&&n[1]==this.y)return!0}}catch(i){t.e(i)}finally{t.f()}return!1}},methods:{isPoint:function(){var e,t=Object(c["a"])(arguments);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(this.x===n[0]&&this.y===n[1])return!0}}catch(i){t.e(i)}finally{t.f()}return!1}}},v=p,d=n("2877"),h=Object(d["a"])(v,o,u,!1,null,null,null),f=h.exports,m=n("bc3a").default.create({}),g="0123456789",b="abcdefghi",y={name:"App",components:{"m-piece":f},data:function(){return{rangeX:[0,1,2,3,4,5,6,7,8],board:[],boardStr:"9/9/9/9/9/9/9/9/9/9",active:null,gameId:null,validMoves:[],humanSide:null,netSide:null,processing:!1,lastMove:""}},methods:{initCanvas:function(){for(var e=document.getElementsByClassName("myCanvas"),t=0;t<e.length;t++){var n=e[t].getContext("2d");n.beginPath(),n.moveTo(0,0),n.lineTo(44.25,44.25),n.rotate(900),n.stroke()}for(var i=document.getElementsByClassName("myCanvas2"),a=0;a<i.length;a++){var r=i[a].getContext("2d");r.beginPath(),r.moveTo(44.25,0),r.lineTo(0,44.25),r.rotate(900),r.stroke()}},reset:function(){this.active=null,this.gameId=null,this.humanSide=null,this.netSide=null,this.boardStr="9/9/9/9/9/9/9/9/9/9",this.lastMove="",this.initGame()},onPieceClick:function(e,t){if(!this.processing){if(this.active){if(this.active[0]==e&&this.active[1]==t)return void(this.active=null);var n,i=Object(c["a"])(this.activeValidTarget);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a[0]===e&&a[1]===t)return void this.remoteDoMove(this.active[0],this.active[1],e,t)}}catch(r){i.e(r)}finally{i.f()}}null===this.board[t][e]||(this.active=[e,t])}},initGame:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.processing=!0,t.prev=1,t.next=4,m.post("/game");case 4:n=t.sent,e.loadResponse(n),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](1),alert(t.t0);case 11:return t.prev=11,e.processing=!1,t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[1,8,11,14]])})))()},loadResponse:function(e){if(e.data.end)return alert("Winner: "+e.data.end==="b"?"黑":"红"),void this.reset();this.boardStr=e.data.state,this.gameId=e.data.id,this.validMoves=e.data.validMoves,this.humanSide=e.data.humanSide,this.netSide=e.data.netSide,this.lastMove=e.data.lastMove},coordToFen:function(e,t){return"".concat(b[e]).concat(g[t])},fenToCoord:function(e){return[b.indexOf(e[0]),g.indexOf(e[1])]},remoteDoMove:function(e,t,n,i){var a=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var s,c,o,u,l;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return s=a.coordToFen(e,t),c=a.coordToFen(n,i),o=s+c,a.$set(a.board[i],n,a.board[t][e]),a.$set(a.board[t],e,null),a.active=null,u=new FormData,u.append("uuid",a.gameId),u.append("move",o),r.prev=9,a.processing=!0,r.next=13,m.post("/game/interact",u,{headers:{"Content-Type":"multipart/form-data"}});case 13:l=r.sent,a.loadResponse(l),r.next=20;break;case 17:r.prev=17,r.t0=r["catch"](9),alert(r.t0);case 20:return r.prev=20,a.processing=!1,r.finish(20);case 23:case"end":return r.stop()}}),r,null,[[9,17,20,23]])})))()}},computed:{pieceArgs:function(){return{board:this.board,active:this.active,targets:this.activeValidTarget,lastMoveCoords:this.lastMoveCoords}},activePiece:function(){return this.active?this.coordToFen(this.active[0],this.active[1]):null},activeValidTarget:function(){if(!this.activePiece||!this.validMoves)return[];var e,t=[],n=Object(c["a"])(this.validMoves);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.startsWith(this.activePiece)&&t.push(this.fenToCoord(i.substring(2)))}}catch(a){n.e(a)}finally{n.f()}return t},humanSideText:function(){return"b"===this.humanSide?"黑":"w"===this.humanSide?"红":null},humanSideStyle:function(){return"b"===this.humanSide?{color:"black"}:"w"===this.humanSide?{color:"red"}:{color:"black"}},lastMoveCoords:function(){return this.lastMove?[this.fenToCoord(this.lastMove.substring(0,2)),this.fenToCoord(this.lastMove.substring(2))]:[]}},mounted:function(){this.initCanvas(),this.initGame()},watch:{boardStr:{immediate:!0,handler:function(e){var t,n=[[]],i=n[0],a=Object(c["a"])(e);try{for(a.s();!(t=a.n()).done;){var r=t.value;if("/"===r)i=[],n.push(i);else if(-1!==g.indexOf(r))for(var s=parseInt(r,10),o=0;o<s;o++)i.push(null);else i.push(r)}}catch(u){a.e(u)}finally{a.f()}this.board=n}}}},C=y,_=(n("5c0b"),Object(d["a"])(C,a,r,!1,null,null,null)),x=_.exports;i["a"].config.productionTip=!1,new i["a"]({render:function(e){return e(x)}}).$mount("#app")},"5c0b":function(e,t,n){"use strict";n("9c0c")},"9c0c":function(e,t,n){}});
//# sourceMappingURL=app.a34faad7.js.map